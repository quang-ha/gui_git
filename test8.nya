DEFINE NODE()
{
CREATE NOR A(1), B(1);
CONNECT A->B.I1;
INPUT I1 = A.I1;
OUTPUT X = B;
};
DEFINE ADDER()
{
CREATE XOR X1(),X2() & AND A1(2),A2(2) & NOR N1(2)
& NODE NA(),NB(),NC();
CONNECT NA->X1.I1, NA->A2.I1, NB->X1.I2, NB->A2.I2,
X1->X2.I1, X1->A1.I1, NC->X2.I2, NC->A1.I2,
A1->N1.I1, A2->N1.I2;
INPUT A = NA.I1, B = NB.I1, CIN = NC.I1;
OUTPUT S = X2, COUT = N1;
};
DEFINE SHIFT1(A)
{
CREATE SWITCH S(A) & AND G(2) & NOR N(1) & DTYPE D();
CONNECT N->D.CLEAR, G->D.SET, G->N.I1, S->G.I2;
INPUT CLK=D.CLK, DATA=D.DATA, SET=G.I1;
OUTPUT Q=D.Q;
};
DEFINE SHIFT2(A0,A1)
{
CREATE SHIFT1 S0(A0), S1(A1) & NODE SN(),CN();
CONNECT CN->S0.CLK, CN->S1.CLK, SN->S0.SET, SN->S1.SET,
S1.Q->S0.DATA;
INPUT CLK=CN.I1, DATA=S1.DATA, SET=SN.I1;
OUTPUT Q0=S0.Q, Q1=S1.Q;
};
DEFINE SHIFT4(A3,A2,A1,A0)
{
CREATE SHIFT2 S0(A0,A1), S1(A2,A3) & NODE SN(),CN();
CONNECT CN->S0.CLK, CN->S1.CLK, SN->S0.SET, SN->S1.SET,
S1.Q0->S0.DATA;
INPUT CLK=CN.I1, IN=S1.DATA, SET=SN.I1;
OUTPUT Q0=S0.Q0, Q1=S0.Q1, Q2=S1.Q0, Q3=S1.Q1;
};
DEFINE ADDER4(A3,A2,A1,A0,B3,B2,B1,B0)
{
CREATE SHIFT4 A(A3,A2,A1,A0),B(B3,B2,B1,B0)
& ADDER A1() & DTYPE D1() & CLOCK C1(1)
& SWITCH S1(0), S2(0), S3(0) & NODE SN();
CONNECT A.Q0->A1.A, B.Q0->A1.B, A1.S->A.IN,
C1->A.CLK, C1->B.CLK, C1->D1.CLK,
SN->A.SET, SN->B.SET,
A1.COUT->D1.DATA, D1.Q->A1.CIN,
S1->B.IN, S2->D1.CLEAR, S3->D1.SET;
INPUT SET=SN.I1;
OUTPUT Q0=A.Q0, Q1=A.Q1, Q2=A.Q2, Q3=A.Q3;
};
CREATE ADDER4 A1(0,1,0,0,0,1,1,0) & SWITCH SET(1);
CONNECT SET->A1.SET;
MONITOR A1.Q0, A1.Q1, A1.Q2, A1.Q3;